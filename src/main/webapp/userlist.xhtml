<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="template/template.xhtml">
	<ui:define name="content">
		<h2>#{label.userlist}</h2>
		<br />
		<br />
		<h:form id="form">
			<p:growl id="growl" showDetail="true" />

			<h:outputLabel value="#{error.userempty}"
				rendered="#{empty userListJsf.allUsers}" styleClass="messages" />

			<p:dataTable id="users" var="currentUser"
				value="#{userListJsf.allUsers}" editable="true"
				rendered="#{not empty userListJsf.allUsers}" rows="5"
				scrollable="true" scrollRows="2" stickyHeader="true"
				paginator="true" paginatorPosition="top"
				paginatorAlwaysVisible="false">

				<p:ajax event="rowEdit" listener="#{userListJsf.onRowEdit}"
					update=":form:growl" />
				<p:ajax event="rowEditCancel" listener="#{userListJsf.onRowCancel}"
					update=":form:growl" resetValues="true" />

				<f:facet name="header">#{label.userlist}</f:facet>

				<p:column headerText="#{label.id}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.id}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.id}" label="#{label.id}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.username}"
					sortBy="#{currentUser.userName}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.userName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.userName}"
								label="#{label.username}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.firstname}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.firstName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.firstName}"
								label="#{label.firstname}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.lastname}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.lastName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.lastName}"
								label="#{label.lastname}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.email}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.email}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.email}" label="#{label.email}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.password}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.password}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.password}"
								label="#{label.password}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.birthdate}">
					<p:cellEditor>
						<f:facet name="output">
							<p:outputLabel value="#{currentUser.birthDate}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy" />
							</p:outputLabel>
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.birthDate}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy" />
							</p:inputText>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.admin}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{currentUser.admin}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.admin}" label="#{label.admin}" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.signupdate}">
					<p:cellEditor>
						<f:facet name="output">
							<p:outputLabel value="#{currentUser.signUpDate}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm:ss" />
							</p:outputLabel>
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{currentUser.signUpDate}">
								<f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm:ss" />
							</p:inputText>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{label.actions}">
					<p:rowEditor />
					<p:commandLink styleClass="ui-icon ui-icon-trash"
						update=":form:deleteConfirmDialog"
						oncomplete="PF('deleteConfirmation').show();"
						action="#{userListJsf.setCurrentUser(currentUser)}">
					</p:commandLink>
				</p:column>

			</p:dataTable>

			<p:confirmDialog id="deleteConfirmDialog"
				header="#{label.confirmation}" severity="alert"
				widgetVar="deleteConfirmation"
				message="#{label.confirmdelete} #{userListJsf.currentUser.userName} ?"
				closeOnEscape="true">
				<p:commandButton id="confirm" value="#{label.valid}"
					oncomplete="PF('deleteConfirmation').hide();" update=":form:growl"
					action="#{userListJsf.delete()}" process="@this" />
				<p:commandButton id="decline" value="#{label.cancel}"
					oncomplete="PF('deleteConfirmation').hide();" />
			</p:confirmDialog>

			<!-- Buttons -->
			<br />
			<br />
			<h:panelGrid columns="2">
				<h:outputLabel for="create">
					<h:outputText id="createLabel" value="#{label.newuser}" />
				</h:outputLabel>
				<h:commandButton id="create" value="#{label.ok}"
					action="usersignup?faces-redirect=true" />
			</h:panelGrid>
			<br />
			<br />
		</h:form>

	</ui:define>
</ui:composition>
</html>